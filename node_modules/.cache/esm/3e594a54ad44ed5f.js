let User,multer,path,fs;_ad4‍.x([["default",()=>_ad4‍.o]]);_ad4‍.w("../model/User",[["default",["User"],function(v){User=v}]]);_ad4‍.w("multer",[["default",["multer"],function(v){multer=v}]]);_ad4‍.w("path",[["default",["path"],function(v){path=v}]]);_ad4‍.w("fs",[["default",["fs"],function(v){fs=v}]]);





  const storage = multer.diskStorage({
    destination: (req,file,cb) => cb(null, 'uploads/'),
    filename: (req, file, cb) => {
      cb(null, Date.now() + "-" + file.originalname)
    },
      
    });

const handleMultipartData = multer({ storage, limit: {filesize : 1000000 * 5 }}).single('resume');
const userController = {

    async apply(req, res) {
            handleMultipartData(req,res, async (err) => {

                const { name, email, phone, linkedin, resume, reference } = req.body;
                const filePath = req.file.path;
                  _ad4‍.g.console.log(filePath)
                  let document;
                try{
                   document = await User.create({
                    name,
                    email,
                    phone,
                    linkedin, 
                    resume: filePath,
                    reference

                });
                      _ad4‍.g.console.log(document);
                  }
                  catch(err){
                     _ad4‍.g.console.log(err)
                  }
                  res.status(201).json({
                      success:true,
                      data: document
                  }); 
              });
         
            },
            async index(req, res) {
              const userdata = await User.find(
              );
               res.status(201).json(userdata);
             
            },
            async download(req,res){
              let records;
              try{
                    records= await User.findById( req.query.id );

                   }
              catch(error){
                _ad4‍.g.console.log(error)
              }
              //res.json(records)
              _ad4‍.g.console.log
             res.download(records.resume)
             // res.download(`./${records.resume}`);
          
            }                    
}
_ad4‍.d(userController);