let Batch,Signup;_e21‍.x([["default",()=>_e21‍.o]]);_e21‍.w("../model/Batch",[["default",["Batch"],function(v){Batch=v}]]);_e21‍.w("../model/Signup",[["default",["Signup"],function(v){Signup=v}]]);


const batchController = {
    async storebatch(req,res){
        const  { name } = req.body;
        let data;
        try{
            data = await Batch.create({
                name,
            });
        }
        catch(err){
           _e21‍.g.console.log(err)
        }
        res.status(201).json(data);
  
    },
    async getbatch(req,res) {
            const batchrecord = await Batch.find(
            );
            res.status(201).json(batchrecord);

            _e21‍.g.console.log(batchrecord, "check")
    },
    async assignbatch(req,res) {
        const  { batch } = req.body;
       _e21‍.g.console.log("data",batch,req.params.id)
        let records;
        try{
            records = await Signup.findOneAndUpdate({_id: req.params.id },{
                $set:{batch: batch}
         
            },{new:true})
            _e21‍.g.console.log(records)
            res.status(200).json({
                sucess:true,
                data:records
            })
        }
        catch(err){
            _e21‍.g.console.log(err)
            res.status(400).json({
                sucess:false,
                data:null,
                
            })
        }

    },
    async get(req,res) {

        const batch = await Batch.find();
        if(!batch){
            res.status(400).json({sucess:false })
        }
        let data=[]
        for(let x of batch){
        const user = await Signup.find({batch:x._id});
        data.push({name:x.name,users:user, _id:x._id})

        }
       res.status(201).json(data);
    },



    
    
    
    
}
_e21‍.d(batchController);